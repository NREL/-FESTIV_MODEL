=start
Q_SU_GENLIMITLOW_TRAJECTORY1(GEN,INTERVAL)$(ORD(INTERVAL) LE CARD(INTERVAL) - SHUTDOWN_PERIOD(GEN) AND (ORD(INTERVAL) GE STARTUP_PERIOD(GEN)-INTERVALS_STARTED_AGO(GEN)))..
GEN_SCHEDULE(GEN,INTERVAL)
         - SUM(RESERVETYPE$(RESERVEVALUE(RESERVETYPE,"RESERVE_ON")EQ 1 AND (RESERVEVALUE(RESERVETYPE,"RESERVE_DIR") EQ 2 OR RESERVEVALUE(RESERVETYPE,"RESERVE_DIR") EQ 3)),
         GEN_RESERVE_SCHEDULE(GEN,INTERVAL,RESERVETYPE)) =G= GENVALUE(GEN,"MIN_GEN")*(UNIT_STATUS(GEN,INTERVAL)
         - SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE (ORD(INTERVAL) + SHUTDOWN_PERIOD(GEN)-1)),UNIT_SHUTDOWN(GEN,H))
         - SUM(H$(ORD(H) LE ORD(INTERVAL) AND ORD(H) GE (ORD(INTERVAL) - STARTUP_PERIOD(GEN)+1 )),UNIT_STARTUP(GEN,H))
         ) +
         SUM(H$(ORD(H) LE ORD(INTERVAL) AND ORD(H) GE (ORD(INTERVAL) - STARTUP_PERIOD(GEN)+1 )),
         (ORD(INTERVAL)-ORD(H)+1)*UNIT_STARTUP(GEN,H))*GENVALUE(GEN,"MIN_GEN")*MIN(1,RTCINTERVAL_LENGTH/(60*GENVALUE(GEN,"STARTUP_TIME")))
         +
         SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE (ORD(INTERVAL) + SHUTDOWN_PERIOD(GEN)-1)),
         (ORD(H)-ORD(INTERVAL))*GENVALUE(GEN,"MIN_GEN")*UNIT_SHUTDOWN(GEN,H))*MIN(1,(RTCINTERVAL_LENGTH/(GENVALUE(GEN,"SHUTDOWN_TIME")*60)))

         - PUMPING(GEN,INTERVAL)*STORAGEVALUE(GEN,"MAX_PUMP")
;
=end
=start
Q_SU_GENLIMITLOW_TRAJECTORY2(GEN,INTERVAL)$(ORD(INTERVAL) LT  STARTUP_PERIOD(GEN)-INTERVALS_STARTED_AGO(GEN))..
GEN_SCHEDULE(GEN,INTERVAL)
         - SUM(RESERVETYPE$(RESERVEVALUE(RESERVETYPE,"RESERVE_ON")EQ 1 AND (RESERVEVALUE(RESERVETYPE,"RESERVE_DIR") EQ 2 OR RESERVEVALUE(RESERVETYPE,"RESERVE_DIR") EQ 3)),
         GEN_RESERVE_SCHEDULE(GEN,INTERVAL,RESERVETYPE)) =G= GENVALUE(GEN,"MIN_GEN")*(UNIT_STATUS(GEN,INTERVAL)
         - SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE (ORD(INTERVAL) + SHUTDOWN_PERIOD(GEN)-1)),UNIT_SHUTDOWN(GEN,H))
         - INITIAL_STARTUP_PERIODS(GEN) - LAST_STARTUP(GEN) - SUM(H$(ORD(H) LE ORD(INTERVAL)),UNIT_STARTUP(GEN,H))
         ) +
         (INITIAL_STARTUP_PERIODS(GEN)+LAST_STARTUP(GEN))*(INTERVALS_STARTED_AGO(GEN)+ ORD(INTERVAL))*GENVALUE(GEN,"MIN_GEN")*MIN(1,RTCINTERVAL_LENGTH/(60*GENVALUE(GEN,"STARTUP_TIME"))) +
         SUM(H$(ORD(H) LE ORD(INTERVAL)),
         (ORD(INTERVAL)-ORD(H)+1)*RTCINTERVAL_LENGTH*UNIT_STARTUP(GEN,H))*GENVALUE(GEN,"MIN_GEN")/(60*GENVALUE(GEN,"STARTUP_TIME"))
         +
         SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE (ORD(INTERVAL) + SHUTDOWN_PERIOD(GEN)-1)),
         (ORD(H)-ORD(INTERVAL))*UNIT_SHUTDOWN(GEN,H))*(GENVALUE(GEN,"MIN_GEN")*MIN(1,RTCINTERVAL_LENGTH/(GENVALUE(GEN,"SHUTDOWN_TIME")*60)))
         - PUMPING(GEN,INTERVAL)*STORAGEVALUE(GEN,"MAX_PUMP")
;
=end
=start
Q_SU_GENLIMITLOW_TRAJECTORY3(GEN,INTERVAL)$(ORD(INTERVAL) GT  CARD(INTERVAL) - SHUTDOWN_PERIOD(GEN) AND ORD(INTERVAL) GE STARTUP_PERIOD(GEN) - INTERVALS_STARTED_AGO(GEN))..
GEN_SCHEDULE(GEN,INTERVAL)
         - SUM(RESERVETYPE$(RESERVEVALUE(RESERVETYPE,"RESERVE_ON")EQ 1 AND (RESERVEVALUE(RESERVETYPE,"RESERVE_DIR") EQ 2 OR RESERVEVALUE(RESERVETYPE,"RESERVE_DIR") EQ 3)),
         GEN_RESERVE_SCHEDULE(GEN,INTERVAL,RESERVETYPE)) =G= GENVALUE(GEN,"MIN_GEN")*(UNIT_STATUS(GEN,INTERVAL)
         - SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE CARD(INTERVAL)),UNIT_SHUTDOWN(GEN,H))
         - SUM(H$(ORD(H) LE ORD(INTERVAL) AND ORD(H) GE (ORD(INTERVAL) - STARTUP_PERIOD(GEN) + 1)),UNIT_STARTUP(GEN,H))
         ) +
         SUM(H$(ORD(H) LE ORD(INTERVAL) AND ORD(H) GE (ORD(INTERVAL) - STARTUP_PERIOD(GEN)+1 )),
         (ORD(INTERVAL)-ORD(H)+1)*UNIT_STARTUP(GEN,H))*GENVALUE(GEN,"MIN_GEN")*MIN(1,RTCINTERVAL_LENGTH/(60*GENVALUE(GEN,"STARTUP_TIME")))
         +
         SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE CARD(INTERVAL) ),
         (ORD(H)-ORD(INTERVAL))*GENVALUE(GEN,"MIN_GEN")*UNIT_SHUTDOWN(GEN,H))*MIN(1,(RTCINTERVAL_LENGTH/(GENVALUE(GEN,"SHUTDOWN_TIME")*60)))
         - PUMPING(GEN,INTERVAL)*STORAGEVALUE(GEN,"MAX_PUMP")
;
=end
=start
Q_SU_RAMPUP_TRAJECTORY1(RAMP_LIMITED_GEN,INTERVAL)$(ORD(INTERVAL) GT STARTUP_PERIOD(RAMP_LIMITED_GEN) - INTERVALS_STARTED_AGO(RAMP_LIMITED_GEN) AND ORD(INTERVAL) GT 1)..
GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL) - GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL-1)
         =L= GENVALUE(RAMP_LIMITED_GEN,"RAMP_RATE")*RTCINTERVAL_LENGTH*(UNIT_STATUS(RAMP_LIMITED_GEN,INTERVAL)
         - SUM(H$(ORD(H) LE ORD(INTERVAL) AND ORD(H) GT (ORD(INTERVAL) - STARTUP_PERIOD(RAMP_LIMITED_GEN))),UNIT_STARTUP(RAMP_LIMITED_GEN,H))
         ) + GENVALUE(RAMP_LIMITED_GEN,"MIN_GEN")*(RTCINTERVAL_LENGTH/(60*GENVALUE(RAMP_LIMITED_GEN,"STARTUP_TIME")))
         *SUM(H$(ORD(H) LE ORD(INTERVAL) AND ORD(H) GT (ORD(INTERVAL) - STARTUP_PERIOD(RAMP_LIMITED_GEN))),UNIT_STARTUP(RAMP_LIMITED_GEN,H))
         +RAMP_UP_PENALTY(RAMP_LIMITED_GEN,INTERVAL)
;
=end
=start
Q_SU_RAMPUP_TRAJECTORY2(RAMP_LIMITED_GEN,INTERVAL)$(ORD(INTERVAL) LE  STARTUP_PERIOD(RAMP_LIMITED_GEN)-INTERVALS_STARTED_AGO(RAMP_LIMITED_GEN) AND ORD(INTERVAL) GT 1)..
GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL) - GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL-1)
         =L= GENVALUE(RAMP_LIMITED_GEN,"RAMP_RATE")*RTCINTERVAL_LENGTH*(UNIT_STATUS(RAMP_LIMITED_GEN,INTERVAL)
         - INITIAL_STARTUP_PERIODS(RAMP_LIMITED_GEN) - LAST_STARTUP(RAMP_LIMITED_GEN) - SUM(H$(ORD(H) LE ORD(INTERVAL)),UNIT_STARTUP(RAMP_LIMITED_GEN,H))
         ) + GENVALUE(RAMP_LIMITED_GEN,"MIN_GEN")*(RTCINTERVAL_LENGTH/(60*GENVALUE(RAMP_LIMITED_GEN,"STARTUP_TIME")))
         *(INITIAL_STARTUP_PERIODS(RAMP_LIMITED_GEN) + LAST_STARTUP(RAMP_LIMITED_GEN)
         + SUM(H$(ORD(H) LE ORD(INTERVAL)),UNIT_STARTUP(RAMP_LIMITED_GEN,H)))
         + RAMP_UP_PENALTY(RAMP_LIMITED_GEN,INTERVAL)
;
=end
=start
Q_SU_RAMPDOWN_TRAJECTORY1(RAMP_LIMITED_GEN,INTERVAL)$(ORD(INTERVAL) LE (CARD(INTERVAL) - SHUTDOWN_PERIOD(RAMP_LIMITED_GEN)) AND ORD(INTERVAL) GT 1)..
GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL-1) - GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL)
          =L= GENVALUE(RAMP_LIMITED_GEN,"RAMP_RATE")*RTCINTERVAL_LENGTH*(UNIT_STATUS(RAMP_LIMITED_GEN,INTERVAL-1)
          - SUM(H$(ORD(H) GE ORD(INTERVAL) AND (ORD(H) LE (ORD(INTERVAL) + SHUTDOWN_PERIOD(RAMP_LIMITED_GEN)-1))),UNIT_SHUTDOWN(RAMP_LIMITED_GEN,H)))
          + (GENVALUE(RAMP_LIMITED_GEN,"MIN_GEN")*(RTCINTERVAL_LENGTH/(GENVALUE(RAMP_LIMITED_GEN,"SHUTDOWN_TIME")*60))
          *SUM(H$(ORD(H) GE ORD(INTERVAL) AND (ORD(H) LE (ORD(INTERVAL) + SHUTDOWN_PERIOD(RAMP_LIMITED_GEN)-1))),UNIT_SHUTDOWN(RAMP_LIMITED_GEN,H)))
          + RAMP_DOWN_PENALTY(RAMP_LIMITED_GEN,INTERVAL)
;
=end
=start
Q_SU_RAMPDOWN_TRAJECTORY2(RAMP_LIMITED_GEN,INTERVAL)$(ORD(INTERVAL) GT  (CARD(INTERVAL) - SHUTDOWN_PERIOD(RAMP_LIMITED_GEN)) AND ORD(INTERVAL) GT 1)..
GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL-1) - GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL)
         =L= GENVALUE(RAMP_LIMITED_GEN,"RAMP_RATE")*RTCINTERVAL_LENGTH*(UNIT_STATUS(RAMP_LIMITED_GEN,INTERVAL-1)
         - SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE CARD(INTERVAL)),UNIT_SHUTDOWN(RAMP_LIMITED_GEN,H)))
         + (GENVALUE(RAMP_LIMITED_GEN,"MIN_GEN")*(RTCINTERVAL_LENGTH/(GENVALUE(RAMP_LIMITED_GEN,"SHUTDOWN_TIME")*60))
         *SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE CARD(INTERVAL)),UNIT_SHUTDOWN(RAMP_LIMITED_GEN,H)))
         + RAMP_DOWN_PENALTY(RAMP_LIMITED_GEN,INTERVAL)
;
=end
=start
Q_SU_RESERVE_TRAJECTORY1(GEN,INTERVAL,RESERVETYPE)$(ORD(INTERVAL) LE CARD(INTERVAL) - SHUTDOWN_PERIOD(GEN) AND (ORD(INTERVAL) GE STARTUP_PERIOD(GEN))-1)..
GEN_RESERVE_SCHEDULE(GEN,INTERVAL,RESERVETYPE) =L= GENVALUE(GEN,"CAPACITY")*(1
         - SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE (ORD(INTERVAL) + SHUTDOWN_PERIOD(GEN)-1)),UNIT_SHUTDOWN(GEN,H))
         - SUM(H$(ORD(H) LE ORD(INTERVAL) AND ORD(H) GE (ORD(INTERVAL) - STARTUP_PERIOD(GEN) + 1)),UNIT_STARTUP(GEN,H))
         )
;
=end
=start
Q_SU_RESERVE_TRAJECTORY2(GEN,INTERVAL,RESERVETYPE)$(ORD(INTERVAL) LT  STARTUP_PERIOD(GEN)-INTERVALS_STARTED_AGO(GEN)-1)..
GEN_RESERVE_SCHEDULE(GEN,INTERVAL,RESERVETYPE) =L= GENVALUE(GEN,"CAPACITY")*(1
         - SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE (ORD(INTERVAL) + SHUTDOWN_PERIOD(GEN)-1)),UNIT_SHUTDOWN(GEN,H))
         - INITIAL_STARTUP_PERIODS(GEN) - SUM(H$(ORD(H) LE ORD(INTERVAL)),UNIT_STARTUP(GEN,H))
         )
;
=end
=start
Q_SU_RESERVE_TRAJECTORY3(GEN,INTERVAL,RESERVETYPE)$(ORD(INTERVAL) GT  CARD(INTERVAL) - SHUTDOWN_PERIOD(GEN))..
GEN_RESERVE_SCHEDULE(GEN,INTERVAL,RESERVETYPE) =L= GENVALUE(GEN,"CAPACITY")*(1
         - SUM(H$(ORD(H) GE ORD(INTERVAL) AND ORD(H) LE CARD(INTERVAL)),UNIT_SHUTDOWN(GEN,H))
         - SUM(H$(ORD(H) LE ORD(INTERVAL) AND ORD(H) GE (ORD(INTERVAL) - STARTUP_PERIOD(GEN) + 1)),UNIT_STARTUP(GEN,H))
         )
;
=end
=start
Q_SD_MINGEN(RAMP_LIMITED_GEN,INTERVAL)$(LAST_GEN_SCHEDULE(RAMP_LIMITED_GEN) - 0.0000001 GT GENVALUE(RAMP_LIMITED_GEN,"MIN_GEN") AND ORD(INTERVAL) EQ 1 AND INITIAL_DISPATCH_SLACK("IGNORE_BP") EQ 0)..
GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL) =G= GENVALUE(RAMP_LIMITED_GEN,"MIN_GEN")
;
=end
=start
Q_REDUCE_GEN_FOR_DELAYED_SD1(RAMP_LIMITED_GEN,INTERVAL)$(ORD(INTERVAL) EQ 1)..
GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL) =L= GENVALUE(RAMP_LIMITED_GEN,"CAPACITY")*(1-DELAYSD(RAMP_LIMITED_GEN))
                                            + MAX(GENVALUE(RAMP_LIMITED_GEN,"MIN_GEN"),(LAST_GEN_SCHEDULE(RAMP_LIMITED_GEN)-GENVALUE(RAMP_LIMITED_GEN,"RAMP_RATE")*RTCINTERVAL_LENGTH)*DELAYSD(RAMP_LIMITED_GEN))
;
=end
=start
Q_REDUCE_GEN_FOR_DELAYED_SD2(RAMP_LIMITED_GEN,INTERVAL)..
GEN_SCHEDULE(RAMP_LIMITED_GEN,INTERVAL) =L= GENVALUE(RAMP_LIMITED_GEN,"CAPACITY")*(1-DELAYSD(RAMP_LIMITED_GEN))
                                            + MAX(GENVALUE(RAMP_LIMITED_GEN,"MIN_GEN"),(LAST_GEN_SCHEDULE(RAMP_LIMITED_GEN)-ORD(INTERVAL)*GENVALUE(RAMP_LIMITED_GEN,"RAMP_RATE")*RTCINTERVAL_LENGTH)*DELAYSD(RAMP_LIMITED_GEN))
;
=end