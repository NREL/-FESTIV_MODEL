=start
Q_STORAGE_GENERATING_START(CONVENTIONAL_STORAGE_GEN,INTERVAL)$(ORD(INTERVAL) EQ 1)..
STORAGE_LEVEL(CONVENTIONAL_STORAGE_GEN,INTERVAL) =E= STORAGEVALUE(CONVENTIONAL_STORAGE_GEN,"INITIAL_STORAGE")
         - INTERVAL_MINUTES(INTERVAL)/60*GEN_EFFICIENCY(CONVENTIONAL_STORAGE_GEN,INTERVAL)
         + INTERVAL_MINUTES(INTERVAL)/60*PUMP_EFFICIENCY(CONVENTIONAL_STORAGE_GEN,INTERVAL)
;
=end
=start
Q_STORAGE_GENERATING(CONVENTIONAL_STORAGE_GEN,INTERVAL)$(ORD(INTERVAL) GT 1)..
STORAGE_LEVEL(CONVENTIONAL_STORAGE_GEN,INTERVAL) =E= STORAGE_LEVEL(CONVENTIONAL_STORAGE_GEN,INTERVAL-1)
         - INTERVAL_MINUTES(INTERVAL)/60*GEN_EFFICIENCY(CONVENTIONAL_STORAGE_GEN,INTERVAL)
         + INTERVAL_MINUTES(INTERVAL)/60*PUMP_EFFICIENCY(CONVENTIONAL_STORAGE_GEN,INTERVAL)
;
=end
=start
Q_STORAGE_END(CONVENTIONAL_STORAGE_GEN)$(STORAGEVALUE(CONVENTIONAL_STORAGE_GEN,"ENFORCE_FINAL_STORAGE") EQ 1)..
SUM(INTERVAL$(ORD(INTERVAL) EQ CARD(INTERVAL)),STORAGE_LEVEL(STORAGE_GEN,INTERVAL)) =E= STORAGEVALUE(STORAGE_GEN,"FINAL_STORAGE") + END_STORAGE_PENALTY_PLUS(STORAGE_GEN) - END_STORAGE_PENALTY_MINUS(STORAGE_GEN)
;
=end
=start
Q_STORAGE_MAX(STORAGE_GEN,INTERVAL)..
STORAGE_LEVEL(STORAGE_GEN,INTERVAL) =L= STORAGEVALUE(STORAGE_GEN,"STORAGE_MAX") + WASTED_STORAGE(STORAGE_GEN,INTERVAL)
;
=end
=start
Q_STORAGE_PUMP_EFFICIENCY1(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)..
CONVENTIONAL_PUMP_SCHEDULE(VARIABLE_EFFICIENCY_STORAGE,INTERVAL) =L= SUM(STORAGEPUMPEFFICIENCYBLOCK(G,EFFICIENCY_BLOCK)$(SAMEAS(VARIABLE_EFFICIENCY_STORAGE,G)),
         PUMP_EFFICIENCY_INDICATOR(G,INTERVAL,EFFICIENCY_BLOCK)*PUMP_EFFICIENCY_MW(G,EFFICIENCY_BLOCK))
;
=end
=start
Q_STORAGE_PUMP_EFFICIENCY2(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)..
CONVENTIONAL_PUMP_SCHEDULE(VARIABLE_EFFICIENCY_STORAGE,INTERVAL) =G= SUM(STORAGEPUMPEFFICIENCYBLOCK(G,EFFICIENCY_BLOCK)$(SAMEAS(VARIABLE_EFFICIENCY_STORAGE,G) AND ORD(EFFICIENCY_BLOCK) EQ 1),
         PUMP_EFFICIENCY_INDICATOR(G,INTERVAL,EFFICIENCY_BLOCK)*STORAGEVALUE(G,"MIN_PUMP"))
         + SUM(STORAGEPUMPEFFICIENCYBLOCK(G,EFFICIENCY_BLOCK)$(SAMEAS(VARIABLE_EFFICIENCY_STORAGE,G) AND ORD(EFFICIENCY_BLOCK) GT 1),
                 PUMP_EFFICIENCY_INDICATOR(G,INTERVAL,EFFICIENCY_BLOCK)*PUMP_EFFICIENCY_MW(G,EFFICIENCY_BLOCK-1))
;
=end
=start
Q_STORAGE_PUMP_EFFICIENCY3(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)..
SUM(STORAGEPUMPEFFICIENCYBLOCK(G,EFFICIENCY_BLOCK)$(SAMEAS(VARIABLE_EFFICIENCY_STORAGE,G)),PUMP_EFFICIENCY_INDICATOR(G,INTERVAL,EFFICIENCY_BLOCK)) =L= 1
;
=end
=start
Q_STORAGE_PUMP_EFFICIENCY4(STORAGEPUMPEFFICIENCYBLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK),INTERVAL)..
PUMP_EFFICIENCY_HELPER(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK) =L=
         PUMP_EFFICIENCY_INDICATOR(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK)*PUMP_EFFICIENCY_BLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK)*STORAGEVALUE(VARIABLE_EFFICIENCY_STORAGE,"MAX_PUMP")
;
=end
=start
Q_STORAGE_PUMP_EFFICIENCY5(STORAGEPUMPEFFICIENCYBLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK),INTERVAL)..
PUMP_EFFICIENCY_HELPER(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK) =G=
         PUMP_EFFICIENCY_INDICATOR(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK)*PUMP_EFFICIENCY_BLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK)*STORAGEVALUE(VARIABLE_EFFICIENCY_STORAGE,"MIN_PUMP")
;
=end
=start
Q_STORAGE_PUMP_EFFICIENCY6(STORAGEPUMPEFFICIENCYBLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK),INTERVAL)..
CONVENTIONAL_PUMP_SCHEDULE(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)*PUMP_EFFICIENCY_BLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK) - PUMP_EFFICIENCY_HELPER(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK)
         =L= (1 - PUMP_EFFICIENCY_INDICATOR(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK))*STORAGEVALUE(VARIABLE_EFFICIENCY_STORAGE,"MAX_PUMP")
;
=end
=start
Q_STORAGE_PUMP_EFFICIENCY7(STORAGEPUMPEFFICIENCYBLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK),INTERVAL)..
CONVENTIONAL_PUMP_SCHEDULE(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)*PUMP_EFFICIENCY_BLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK) - PUMP_EFFICIENCY_HELPER(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK)
         =G= 0
;
=end
=start
Q_STORAGE_PUMP_EFFICIENCY8(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)..
PUMP_EFFICIENCY(VARIABLE_EFFICIENCY_STORAGE,INTERVAL) =E= SUM(STORAGEPUMPEFFICIENCYBLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK),PUMP_EFFICIENCY_HELPER(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK))
;
=end
=start
Q_STORAGE_PUMP_EFFICIENCY9(CONSTANT_EFFICIENCY_STORAGE,INTERVAL)..
PUMP_EFFICIENCY(CONSTANT_EFFICIENCY_STORAGE,INTERVAL) =E= STORAGEVALUE(CONSTANT_EFFICIENCY_STORAGE,"EFFICIENCY")*CONVENTIONAL_PUMP_SCHEDULE(CONSTANT_EFFICIENCY_STORAGE,INTERVAL)
;
=end
=start
Q_STORAGE_GEN_EFFICIENCY1(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)..
GEN_SCHEDULE(VARIABLE_EFFICIENCY_STORAGE,INTERVAL) =L= SUM(STORAGEGENEFFICIENCYBLOCK(G,EFFICIENCY_BLOCK)$(SAMEAS(VARIABLE_EFFICIENCY_STORAGE,G)),
         GEN_EFFICIENCY_INDICATOR(G,INTERVAL,EFFICIENCY_BLOCK)*GEN_EFFICIENCY_MW(G,EFFICIENCY_BLOCK))
;
=end
=start
Q_STORAGE_GEN_EFFICIENCY2(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)..
GEN_SCHEDULE(VARIABLE_EFFICIENCY_STORAGE,INTERVAL) =G= SUM(STORAGEGENEFFICIENCYBLOCK(G,EFFICIENCY_BLOCK)$(SAMEAS(VARIABLE_EFFICIENCY_STORAGE,G) AND ORD(EFFICIENCY_BLOCK) EQ 1),
         GEN_EFFICIENCY_INDICATOR(G,INTERVAL,EFFICIENCY_BLOCK)*GENVALUE(G,"MIN_GEN"))
         + SUM(STORAGEGENEFFICIENCYBLOCK(G,EFFICIENCY_BLOCK)$(SAMEAS(VARIABLE_EFFICIENCY_STORAGE,G) AND ORD(EFFICIENCY_BLOCK) GT 1),
                 GEN_EFFICIENCY_INDICATOR(G,INTERVAL,EFFICIENCY_BLOCK)*GEN_EFFICIENCY_MW(G,EFFICIENCY_BLOCK-1))
;
=end
=start
Q_STORAGE_GEN_EFFICIENCY3(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)..
SUM(STORAGEGENEFFICIENCYBLOCK(G,EFFICIENCY_BLOCK)$(SAMEAS(VARIABLE_EFFICIENCY_STORAGE,G)),GEN_EFFICIENCY_INDICATOR(G,INTERVAL,EFFICIENCY_BLOCK)) =L= 1
;
=end
=start
Q_STORAGE_GEN_EFFICIENCY4(STORAGEGENEFFICIENCYBLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK),INTERVAL)..
GEN_EFFICIENCY_HELPER(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK) =L=
         GEN_EFFICIENCY_INDICATOR(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK)*GEN_EFFICIENCY_BLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK)*GENVALUE(VARIABLE_EFFICIENCY_STORAGE,"CAPACITY")
;
=end
=start
Q_STORAGE_GEN_EFFICIENCY5(STORAGEGENEFFICIENCYBLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK),INTERVAL)..
GEN_EFFICIENCY_HELPER(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK) =G=
         GEN_EFFICIENCY_INDICATOR(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK)*GEN_EFFICIENCY_BLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK)*GENVALUE(VARIABLE_EFFICIENCY_STORAGE,"MIN_GEN")
;
=end
=start
Q_STORAGE_GEN_EFFICIENCY6(STORAGEGENEFFICIENCYBLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK),INTERVAL)..
GEN_SCHEDULE(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)*GEN_EFFICIENCY_BLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK) - GEN_EFFICIENCY_HELPER(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK)
         =L= (1 - GEN_EFFICIENCY_INDICATOR(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK))*GENVALUE(VARIABLE_EFFICIENCY_STORAGE,"CAPACITY")
;
=end
=start
Q_STORAGE_GEN_EFFICIENCY7(STORAGEGENEFFICIENCYBLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK),INTERVAL)..
GEN_SCHEDULE(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)*GEN_EFFICIENCY_BLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK) - GEN_EFFICIENCY_HELPER(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK)
         =G= 0
;
=end
=start
Q_STORAGE_GEN_EFFICIENCY8(VARIABLE_EFFICIENCY_STORAGE,INTERVAL)..
GEN_EFFICIENCY(VARIABLE_EFFICIENCY_STORAGE,INTERVAL) =E= SUM(STORAGEGENEFFICIENCYBLOCK(VARIABLE_EFFICIENCY_STORAGE,EFFICIENCY_BLOCK),GEN_EFFICIENCY_HELPER(VARIABLE_EFFICIENCY_STORAGE,INTERVAL,EFFICIENCY_BLOCK))
;
=end
=start
Q_STORAGE_GEN_EFFICIENCY9(CONSTANT_EFFICIENCY_STORAGE,INTERVAL)..
GEN_EFFICIENCY(CONSTANT_EFFICIENCY_STORAGE,INTERVAL) =E= GEN_SCHEDULE(CONSTANT_EFFICIENCY_STORAGE,INTERVAL)
;
=end
